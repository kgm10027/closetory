<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Closetory - ë§ˆì´í˜ì´ì§€</title>
    <style>
        * { box-sizing: border-box; }
        body {
            margin: 0;
            font-family: "Noto Sans KR", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
            background: #f5f7fb;
            color: #111827;
        }

        /* ===== ê³µí†µ ìƒë‹¨ í—¤ë” ===== */
        .clo-topbar {
            position: fixed;
            top: 0; left: 0; right: 0;
            height: 72px;
            background: #ffffff;
            box-shadow: 0 6px 20px rgba(15,23,42,0.06);
            z-index: 50;
        }
        .clo-top-inner {
            max-width: 1180px;
            margin: 0 auto;
            height: 100%;
            padding: 0 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .clo-top-left { display: flex; align-items: center; gap: 14px; }
        .clo-hamburger {
            width: 36px; height: 36px;
            border-radius: 999px;
            border: none;
            background: #111827;
            color: #f9fafb;
            font-size: 18px;
            cursor: pointer;
        }
        .clo-logo-main a {
            text-decoration: none;
            color: inherit;
        }
        .clo-logo-main {
            font-size: 22px;
            font-weight: 900;
            letter-spacing: -0.4px;
            cursor: pointer;
        }
        .clo-logo-sub {
            font-size: 11px;
            color: #9ca3af;
            margin-top: 2px;
        }
        .clo-top-right {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .clo-search-form {
            display: flex;
            align-items: center;
            background: #f3f4f6;
            border-radius: 999px;
            padding: 6px 12px;
            min-width: 260px;
        }
        .clo-search-icon {
            font-size: 14px;
            color: #6b7280;
            margin-right: 6px;
        }
        .clo-search-input {
            border: none;
            background: transparent;
            outline: none;
            font-size: 13px;
            width: 100%;
        }
        .clo-top-btn {
            height: 36px;
            border-radius: 999px;
            border: 1px solid #e5e7eb;
            background: #ffffff;
            padding: 0 14px;
            font-size: 12px;
            cursor: pointer;
            color: #374151;
            display: flex;
            align-items: center;
            justify-content: center;
            white-space: nowrap;
        }
        .clo-top-btn.primary {
            background: #111827;
            color: #f9fafb;
            border-color: #111827;
            font-weight: 600;
        }
        .clo-top-btn:hover { background: #f3f4f6; }
        .clo-top-btn.primary:hover { background: #020617; }
        .clo-user-status {
            font-size: 12px;
            color: #6b7280;
            margin-right: 4px;
        }

        /* ===== ë³¸ë¬¸ ë ˆì´ì•„ì›ƒ ===== */
        .clo-main-outer { padding-top: 96px; }
        .clo-main-wrap {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 24px 40px;
        }
        h1 {
            font-size: 26px;
            margin-bottom: 10px;
        }
        .clo-desc {
            font-size: 13px;
            color: #6b7280;
            margin-bottom: 24px;
        }
        .clo-section {
            background: #ffffff;
            border-radius: 18px;
            padding: 20px 22px 24px;
            box-shadow: 0 12px 28px rgba(15,23,42,0.06);
            margin-bottom: 20px;
        }
        .clo-section-title {
            font-size: 16px;
            font-weight: 800;
            margin-bottom: 12px;
        }
        .clo-section-sub {
            font-size: 12px;
            color: #6b7280;
            margin-bottom: 14px;
        }
        .clo-grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px 24px;
        }
        .clo-field { margin-bottom: 12px; }
        .clo-label {
            display: block;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 6px;
        }
        .clo-input, .clo-select {
            width: 100%;
            padding: 10px 12px;
            border-radius: 10px;
            border: 1px solid #e5e7eb;
            font-size: 13px;
            outline: none;
        }
        .clo-input:focus, .clo-select:focus {
            border-color: #2563eb;
            box-shadow: 0 0 0 1px rgba(37,99,235,0.2);
        }
        .clo-input[readonly] {
            background: #f9fafb;
            color: #6b7280;
        }
        .clo-btn-row {
            margin-top: 10px;
            display: flex;
            justify-content: flex-end;
        }
        .clo-btn {
            border-radius: 999px;
            border: none;
            padding: 9px 16px;
            font-size: 13px;
            cursor: pointer;
            background: #111827;
            color: #f9fafb;
            font-weight: 600;
        }
        .clo-btn:hover { background: #020617; }

        @media (max-width: 768px) {
            .clo-grid-2 { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

<header class="clo-topbar">
    <div class="clo-top-inner">
        <div class="clo-top-left">
            <button class="clo-hamburger" disabled>â˜°</button>
            <div>
                <div class="clo-logo-main">
                    <a href="index.html">Closetory</a>
                </div>
                <div class="clo-logo-sub">ì˜·ì¥ì—ì„œ êº¼ë‚´ëŠ” ì‘ì€ í–‰ë³µ</div>
            </div>
        </div>
        <div class="clo-top-right">
            <form class="clo-search-form" onsubmit="return false;">
                <span class="clo-search-icon">ğŸ”</span>
                <input class="clo-search-input" type="text" placeholder="ì½”ë””, ì•„ì´í…œ ê²€ìƒ‰">
            </form>
            <span class="clo-user-status" id="userStatus"></span>
            <button class="clo-top-btn" id="loginBtn">ë¡œê·¸ì¸</button>
            <button class="clo-top-btn" id="signupBtn">íšŒì›ê°€ì…</button>
            <button class="clo-top-btn primary" id="mypageBtn">ë§ˆì´í˜ì´ì§€</button>
            <button class="clo-top-btn" id="logoutBtn">ë¡œê·¸ì•„ì›ƒ</button>
        </div>
    </div>
</header>

<div class="clo-main-outer">
    <main class="clo-main-wrap">
        <h1>ë§ˆì´í˜ì´ì§€</h1>
        <p class="clo-desc">í”„ë¡œí•„ ì •ë³´ì™€ ì§€ì—­ ì„¤ì •, ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

        <!-- ê¸°ë³¸ ì •ë³´ -->
        <section class="clo-section">
            <div class="clo-section-title">ê¸°ë³¸ ì •ë³´</div>
            <div class="clo-section-sub">ì•„ì´ë””ëŠ” ìˆ˜ì •í•  ìˆ˜ ì—†ê³ , ì´ë¦„ê³¼ ì£¼ì†Œë§Œ ë³€ê²½ ê°€ëŠ¥í•©ë‹ˆë‹¤.</div>
            <div class="clo-grid-2">
                <div class="clo-field">
                    <label class="clo-label" for="userId">ì•„ì´ë”” (ìˆ˜ì • ë¶ˆê°€)</label>
                    <input class="clo-input" id="userId" readonly>
                </div>
                <div class="clo-field">
                    <label class="clo-label" for="userName">ì´ë¦„</label>
                    <input class="clo-input" id="userName">
                </div>
                <div class="clo-field" style="grid-column:1 / -1;">
                    <label class="clo-label" for="userAddress">ì£¼ì†Œ</label>
                    <input class="clo-input" id="userAddress">
                </div>
            </div>
            <div class="clo-btn-row">
                <button class="clo-btn" id="saveProfileBtn">íšŒì› ì •ë³´ ì €ì¥</button>
            </div>
        </section>

        <!-- ì§€ì—­ ì„¤ì • -->
        <section class="clo-section">
            <div class="clo-section-title">ì§€ì—­ ì„¤ì • (ë‚ ì”¨ ì—°ë™)</div>
            <div class="clo-section-sub">
                ì—¬ê¸°ì„œ ì„ íƒí•œ ì‹œ/ë„ëŠ” ë©”ì¸ í™”ë©´ &lt;ì˜¤ëŠ˜ì˜ ì½”ë””&gt; ë‚ ì”¨ ì •ë³´ì— ì‚¬ìš©ë©ë‹ˆë‹¤.
            </div>
            <div class="clo-field">
                <label class="clo-label" for="regionSelect">ê¸°ë³¸ ì§€ì—­ (ì „êµ­ ì‹œ/ë„)</label>
                <select class="clo-select" id="regionSelect">
                    <!-- ì§€ì—­ ì´ë¦„ì€ index.htmlì˜ REGION_GRID í‚¤ë‘ ë°˜ë“œì‹œ ê°™ì•„ì•¼ í•¨ -->
                    <option value="ê²½ê¸° ê³ ì–‘ì‹œ">ê²½ê¸° ê³ ì–‘ì‹œ</option>
                    <option value="ì„œìš¸ ê°•ë‚¨êµ¬">ì„œìš¸ ê°•ë‚¨êµ¬</option>
                    <option value="ì„œìš¸ ë§ˆí¬êµ¬">ì„œìš¸ ë§ˆí¬êµ¬</option>

                    <option value="ì„œìš¸íŠ¹ë³„ì‹œ">ì„œìš¸íŠ¹ë³„ì‹œ(ì „ì²´)</option>
                    <option value="ë¶€ì‚° í•´ìš´ëŒ€êµ¬">ë¶€ì‚° í•´ìš´ëŒ€êµ¬</option>
                    <option value="ë¶€ì‚°ê´‘ì—­ì‹œ">ë¶€ì‚°ê´‘ì—­ì‹œ(ì „ì²´)</option>
                    <option value="ì¸ì²œê´‘ì—­ì‹œ">ì¸ì²œê´‘ì—­ì‹œ</option>
                    <option value="ê´‘ì£¼ê´‘ì—­ì‹œ">ê´‘ì£¼ê´‘ì—­ì‹œ</option>
                    <option value="ëŒ€ì „ê´‘ì—­ì‹œ">ëŒ€ì „ê´‘ì—­ì‹œ</option>
                    <option value="ëŒ€êµ¬ ì¤‘êµ¬">ëŒ€êµ¬ ì¤‘êµ¬</option>
                    <option value="ëŒ€êµ¬ê´‘ì—­ì‹œ">ëŒ€êµ¬ê´‘ì—­ì‹œ(ì „ì²´)</option>
                    <option value="ìš¸ì‚°ê´‘ì—­ì‹œ">ìš¸ì‚°ê´‘ì—­ì‹œ</option>
                    <option value="ì œì£¼íŠ¹ë³„ìì¹˜ë„">ì œì£¼íŠ¹ë³„ìì¹˜ë„</option>

                    <!-- ë„(é“) ë‹¨ìœ„ í° ì§€ì—­ -->
                    <option value="ì „ë‚¨">ì „ë¼ë‚¨ë„(ëŒ€í‘œ)</option>
                    <option value="ê²½ë‚¨">ê²½ìƒë‚¨ë„(ëŒ€í‘œ)</option>

                    <option value="ê¸°íƒ€">ê¸°íƒ€ (ì§ì ‘ ì…ë ¥ ì£¼ì†Œ ê¸°ì¤€)</option>
                </select>
            </div>
            <div class="clo-btn-row">
                <button class="clo-btn" id="saveRegionBtn">ì§€ì—­ ì„¤ì • ì €ì¥</button>
            </div>
        </section>

        <!-- ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ -->
        <section class="clo-section">
            <div class="clo-section-title">ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</div>
            <div class="clo-section-sub">
                í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ë¥¼ í™•ì¸í•œ í›„ ìƒˆ ë¹„ë°€ë²ˆí˜¸ë¡œ ë³€ê²½í•©ë‹ˆë‹¤.
                ë³€ê²½ í›„ ìƒˆ ë¹„ë°€ë²ˆí˜¸ë¡œ ë‹¤ì‹œ ë¡œê·¸ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            </div>
            <div class="clo-field">
                <label class="clo-label" for="currentPw">í˜„ì¬ ë¹„ë°€ë²ˆí˜¸</label>
                <input class="clo-input" id="currentPw" type="password">
            </div>
            <div class="clo-field">
                <label class="clo-label" for="newPw">ìƒˆ ë¹„ë°€ë²ˆí˜¸</label>
                <input class="clo-input" id="newPw" type="password">
            </div>
            <div class="clo-field">
                <label class="clo-label" for="newPw2">ìƒˆ ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label>
                <input class="clo-input" id="newPw2" type="password">
            </div>
            <div class="clo-btn-row">
                <button class="clo-btn" id="changePwBtn">ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</button>
            </div>
        </section>
    </main>
</div>

<script>
    /* ===== ê³µí†µ ë¡œê·¸ì¸ ìƒíƒœ ì²˜ë¦¬ ===== */
    const loginBtn   = document.getElementById('loginBtn');
    const signupBtn  = document.getElementById('signupBtn');
    const logoutBtn  = document.getElementById('logoutBtn');
    const mypageBtn  = document.getElementById('mypageBtn');
    const userStatus = document.getElementById('userStatus');

    function checkAuthState() {
        const raw = localStorage.getItem('closetoryUser');
        if (raw) {
            try {
                const user = JSON.parse(raw);
                userStatus.textContent = (user.name || 'ì‚¬ìš©ì') + ' ë‹˜ ë¡œê·¸ì¸ ì¤‘';
                loginBtn.style.display   = 'none';
                signupBtn.style.display  = 'none';
                mypageBtn.style.display  = 'inline-flex';
                logoutBtn.style.display  = 'inline-flex';
            } catch (e) {
                console.error(e);
                userStatus.textContent = '';
                loginBtn.style.display   = 'inline-flex';
                signupBtn.style.display  = 'inline-flex';
                mypageBtn.style.display  = 'none';
                logoutBtn.style.display  = 'none';
            }
        } else {
            userStatus.textContent = '';
            loginBtn.style.display   = 'inline-flex';
            signupBtn.style.display  = 'inline-flex';
            mypageBtn.style.display  = 'none';
            logoutBtn.style.display  = 'none';
        }
    }

    loginBtn.addEventListener('click', () => location.href = 'login.html');
    signupBtn.addEventListener('click', () => location.href = 'signup.html');
    mypageBtn.addEventListener('click', () => location.href = 'mypage.html');
    logoutBtn.addEventListener('click', () => {
        localStorage.removeItem('closetoryUser');
        alert('ë¡œê·¸ì•„ì›ƒ ë˜ì—ˆìŠµë‹ˆë‹¤.');
        location.href = 'index.html';
    });

    checkAuthState();

    /* ===== ë§ˆì´í˜ì´ì§€ ë°ì´í„° ë¡œë”© ===== */
    const userIdInput      = document.getElementById('userId');
    const userNameInput    = document.getElementById('userName');
    const userAddressInput = document.getElementById('userAddress');
    const regionSelect     = document.getElementById('regionSelect');

    function loadUser() {
        const raw = localStorage.getItem('closetoryUser');
        if (!raw) {
            alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
            location.href = 'login.html';
            return;
        }
        try {
            const user = JSON.parse(raw);

            userIdInput.value      = user.id || '';
            userNameInput.value    = user.name || '';
            userAddressInput.value = user.address || '';

            // regionì´ ì…€ë ‰íŠ¸ ì˜µì…˜ì— ìˆìœ¼ë©´ ê·¸ ê°’ìœ¼ë¡œ, ì—†ìœ¼ë©´ 'ê²½ê¸° ê³ ì–‘ì‹œ'ë¡œ
            if (user.region) {
                const exists = Array.from(regionSelect.options)
                    .some(o => o.value === user.region);

                regionSelect.value = exists ? user.region : 'ê²½ê¸° ê³ ì–‘ì‹œ';
            } else {
                regionSelect.value = 'ê²½ê¸° ê³ ì–‘ì‹œ';
            }

        } catch (e) {
            console.error(e);
            alert('ì‚¬ìš©ì ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        }
    }

    loadUser();

    /* ===== íšŒì› ì •ë³´ ì €ì¥ (ì´ë¦„, ì£¼ì†Œ) ===== */
    document.getElementById('saveProfileBtn').addEventListener('click', () => {
        const raw = localStorage.getItem('closetoryUser');
        if (!raw) return;

        try {
            const user = JSON.parse(raw);
            user.name    = userNameInput.value.trim();
            user.address = userAddressInput.value.trim();

            localStorage.setItem('closetoryUser', JSON.stringify(user));
            alert('íšŒì› ì •ë³´ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
            checkAuthState();
        } catch (e) {
            console.error(e);
            alert('íšŒì› ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        }
    });

    /* ===== ì§€ì—­ ì„¤ì • ì €ì¥ ===== */
    document.getElementById('saveRegionBtn').addEventListener('click', () => {
        const raw = localStorage.getItem('closetoryUser');
        if (!raw) return;

        try {
            const user = JSON.parse(raw);
            user.region = regionSelect.value;

            localStorage.setItem('closetoryUser', JSON.stringify(user));
            alert('ì§€ì—­ ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.\në©”ì¸ í™”ë©´ì˜ ë‚ ì”¨ ì§€ì—­ì— ë°˜ì˜ë©ë‹ˆë‹¤.');
        } catch (e) {
            console.error(e);
            alert('ì§€ì—­ ì„¤ì •ì„ ì €ì¥í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        }
    });

    /* ===== ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ===== */
    document.getElementById('changePwBtn').addEventListener('click', () => {
        const raw = localStorage.getItem('closetoryUser');
        if (!raw) return;

        try {
            const user = JSON.parse(raw);

            const currentPw = document.getElementById('currentPw').value;
            const newPw     = document.getElementById('newPw').value;
            const newPw2    = document.getElementById('newPw2').value;

            if (!currentPw || !newPw || !newPw2) {
                alert('ëª¨ë“  ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ ì¹¸ì„ ì±„ì›Œ ì£¼ì„¸ìš”.');
                return;
            }

            if (currentPw !== user.password) {
                alert('í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
                return;
            }

            if (newPw !== newPw2) {
                alert('ìƒˆ ë¹„ë°€ë²ˆí˜¸ê°€ ì„œë¡œ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
                return;
            }

            user.password = newPw;
            localStorage.setItem('closetoryUser', JSON.stringify(user));

            alert('ë¹„ë°€ë²ˆí˜¸ê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤. ìƒˆ ë¹„ë°€ë²ˆí˜¸ë¡œ ë‹¤ì‹œ ë¡œê·¸ì¸í•´ ì£¼ì„¸ìš”.');
            // ê³„ì •ì€ ê·¸ëŒ€ë¡œ ë‘ê³ , ë¡œê·¸ì¸ë§Œ í’€ê³  ì‹¶ìœ¼ë©´ ì•„ë˜ í•œ ì¤„ì€ ì£¼ì„ ì²˜ë¦¬í•´ë„ ë¨
            localStorage.removeItem('closetoryUser');
            location.href = 'login.html';
        } catch (e) {
            console.error(e);
            alert('ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        }
    });
</script>
</body>
</html>
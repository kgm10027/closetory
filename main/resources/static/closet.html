<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <title>Closetory - ë‚˜ë§Œì˜ ì˜·ì¥</title>
    <style>
        * { box-sizing: border-box; }
        body {
          margin: 0;
          font-family: "Noto Sans KR", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
          background: #f5f7fb;
          color: #111827;
        }

        /* ===== ê³µí†µ ìƒë‹¨ ê³ ì • í—¤ë” (indexì™€ ë™ì¼) ===== */
        .clo-topbar {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          height: 72px;
          background: #ffffff;
          box-shadow: 0 6px 20px rgba(15,23,42,0.06);
          z-index: 50;
        }
        .clo-top-inner {
          max-width: 1180px;
          margin: 0 auto;
          height: 100%;
          padding: 0 24px;
          display: flex;
          align-items: center;
          justify-content: space-between;
        }
        .clo-top-left {
          display: flex;
          align-items: center;
          gap: 14px;
        }
        .clo-hamburger {
          width: 36px;
          height: 36px;
          border-radius: 999px;
          border: none;
          background: #111827;
          color: #f9fafb;
          font-size: 18px;
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
        }
        .clo-logo-main a {
          text-decoration: none;
          color: inherit;
        }
        .clo-logo-main {
          font-size: 22px;
          font-weight: 900;
          letter-spacing: -0.4px;
          cursor: pointer;
        }
        .clo-logo-sub {
          font-size: 11px;
          color: #9ca3af;
          margin-top: 2px;
        }
        .clo-top-right {
          display: flex;
          align-items: center;
          gap: 10px;
        }
        .clo-search-form {
          display: flex;
          align-items: center;
          background: #f3f4f6;
          border-radius: 999px;
          padding: 6px 12px;
          min-width: 260px;
        }
        .clo-search-icon {
          font-size: 14px;
          color: #6b7280;
          margin-right: 6px;
        }
        .clo-search-input {
          border: none;
          background: transparent;
          outline: none;
          font-size: 13px;
          width: 100%;
        }
        .clo-top-btn {
          height: 36px;
          border-radius: 999px;
          border: 1px solid #e5e7eb;
          background: #ffffff;
          padding: 0 14px;
          font-size: 12px;
          cursor: pointer;
          color: #374151;
          display: flex;
          align-items: center;
          justify-content: center;
          white-space: nowrap;
        }
        .clo-top-btn.primary {
          background: #111827;
          color: #f9fafb;
          border-color: #111827;
          font-weight: 600;
        }
        .clo-top-btn:hover { background: #f3f4f6; }
        .clo-top-btn.primary:hover { background: #020617; }
        .clo-user-status {
          font-size: 12px;
          color: #6b7280;
          margin-right: 4px;
        }

        /* ===== ì‚¬ì´ë“œë°” (indexì™€ ë™ì¼) ===== */
        .clo-sidebar {
          position: fixed;
          top: 0;
          left: 0;
          bottom: 0;
          width: 230px;
          background: #111827;
          color: #e5e7eb;
          padding: 24px 20px;
          display: flex;
          flex-direction: column;
          gap: 24px;
          transform: translateX(-100%);
          transition: transform .25s ease-out;
          z-index: 60;
        }
        body.clo-sidebar-open .clo-sidebar {
          transform: translateX(0);
        }
        .clo-sidebar-header {
          font-size: 18px;
          font-weight: 800;
        }
        .clo-sidebar-sub {
          font-size: 12px;
          color: #9ca3af;
          margin-top: 2px;
        }
        .clo-menu-list {
          list-style: none;
          padding: 0;
          margin: 0;
          display: flex;
          flex-direction: column;
          gap: 10px;
          font-size: 14px;
        }
        .clo-menu-list li {
          padding: 8px 10px;
          border-radius: 8px;
          cursor: pointer;
          transition: background .2s, color .2s;
        }
        .clo-menu-list li:hover {
          background: #1f2937;
          color: #f9fafb;
        }
        .clo-menu-list li.clo-active {
          background: #fbbf24;
          color: #111827;
          font-weight: 700;
        }
        .clo-sidebar-footer {
          margin-top: auto;
          font-size: 11px;
          color: #6b7280;
        }
        .clo-backdrop {
          position: fixed;
          inset: 0;
          background: rgba(15,23,42,0.35);
          opacity: 0;
          pointer-events: none;
          transition: opacity .2s ease-out;
          z-index: 55;
        }
        body.clo-sidebar-open .clo-backdrop {
          opacity: 1;
          pointer-events: auto;
        }

        /* ===== ë©”ì¸ ë˜í¼ ===== */
        .clo-main-outer { padding-top: 96px; }
        .clo-main-wrap {
          max-width: 1180px;
          margin: 0 auto;
          padding: 0 24px 40px;
        }

        .clo-page-title-box h1 {
          margin: 0 0 4px;
          font-size: 30px;
          font-weight: 900;
          letter-spacing: -0.5px;
        }
        .clo-page-title-box p {
          margin: 0;
          font-size: 14px;
          color: #6b7280;
        }

        /* ===== ìƒë‹¨ ìŠ¤íƒ€ì¼ ë¶„ì„ ì¹´ë“œ ===== */
        .clo-style-summary {
          margin-top: 24px;
          margin-bottom: 20px;
          padding: 18px 22px;
          border-radius: 18px;
          background: #ffffff;
          box-shadow: 0 10px 22px rgba(15,23,42,0.06);
        }
        .clo-style-summary h2 {
          margin: 0 0 8px;
          font-size: 18px;
          font-weight: 800;
        }
        .clo-style-summary ul {
          margin: 0 0 6px;
          padding-left: 20px;
          font-size: 14px;
        }
        .clo-style-summary li { margin-bottom: 2px; }
        .clo-style-summary small {
          display: block;
          margin-top: 6px;
          font-size: 12px;
          color: #9ca3af;
        }

        /* ===== í•„í„° ì˜ì—­ ===== */
        .clo-filter-bar {
          display: flex;
          align-items: center;
          justify-content: space-between;
          margin-bottom: 16px;
          flex-wrap: wrap;
          gap: 10px 16px;
        }
        .clo-filter-left {
          display: flex;
          align-items: center;
          flex-wrap: wrap;
          gap: 8px;
        }
        .clo-filter-label {
          font-size: 13px;
          margin-right: 6px;
          color: #6b7280;
        }
        .clo-chip {
          display: inline-flex;
          align-items: center;
          justify-content: center;
          min-width: 56px;
          padding: 4px 10px;
          border-radius: 999px;
          border: 1px solid #e5e7eb;
          font-size: 12px;
          cursor: pointer;
          background: #ffffff;
          color: #4b5563;
        }
        .clo-chip::before {
          content: '';
          width: 8px;
          height: 8px;
          border-radius: 999px;
          margin-right: 6px;
          background: #e5e7eb;
        }
        .clo-chip[data-color="ë ˆë“œ"]::before { background: #ef4444; }
        .clo-chip[data-color="ë¸”ë£¨"]::before { background: #3b82f6; }
        .clo-chip[data-color="ê·¸ë¦°"]::before { background: #22c55e; }
        .clo-chip[data-color="ë¸Œë¼ìš´"]::before { background: #b45309; }
        .clo-chip[data-color="ì¹´í‚¤"]::before { background: #6b7280; }
        .clo-chip[data-color="ê·¸ë ˆì´"]::before { background: #9ca3af; }
        .clo-chip[data-color="ë¸”ë™"]::before { background: #111827; }
        .clo-chip[data-color="í™”ì´íŠ¸"]::before { background: #e5e7eb; }

        .clo-chip.active {
          border-color: #111827;
          background: #111827;
          color: #f9fafb;
        }
        .clo-chip.active::before { background: #fbbf24; }

        .clo-filter-right {
          display: flex;
          align-items: center;
          gap: 10px;
          font-size: 12px;
        }
        .clo-filter-right label {
          display: inline-flex;
          align-items: center;
          gap: 4px;
          font-size: 12px;
          color: #4b5563;
          cursor: pointer;
        }
        .clo-select {
          border-radius: 999px;
          border: 1px solid #e5e7eb;
          padding: 4px 10px;
          font-size: 12px;
          background: #ffffff;
        }
        .clo-filter-reset {
          border: none;
          background: none;
          color: #6b7280;
          font-size: 12px;
          text-decoration: underline;
          cursor: pointer;
          margin-left: 6px;
        }

        /* ===== ì¹´ë“œ ê·¸ë¦¬ë“œ (2ë²ˆì§¸ ìŠ¤ìƒ· ëŠë‚Œ) ===== */
        .clo-closet-grid {
          display: grid;
          grid-template-columns: repeat(2, minmax(0,1fr));
          gap: 18px;
          margin-bottom: 32px;
        }
        .clo-closet-card {
          background: #ffffff;
          border-radius: 18px;
          box-shadow: 0 8px 20px rgba(15,23,42,0.05);
          overflow: hidden;
          display: flex;
          flex-direction: column;
          cursor: pointer;
          transition: transform .15s ease, box-shadow .15s ease;
        }
        .clo-closet-card:hover {
          transform: translateY(-3px);
          box-shadow: 0 14px 28px rgba(15,23,42,0.08);
        }
        /* ì¹´ë“œ ì´ë¯¸ì§€: ì „ì²´ê°€ ë³´ì´ë„ë¡ contain + ê°€ìš´ë° ì •ë ¬ */
.clo-card-img-wrap {
  position: relative;
  height: 260px;               /* ì¡°ê¸ˆ ë” í‚¤ì›Œì„œ ì„¸ë¡œ ì´ë¯¸ì§€ë„ ì—¬ìœ  ìˆê²Œ */
  background: #e5e7eb;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}
.clo-card-img {
  max-width: 100%;
  max-height: 100%;
  width: auto;
  height: auto;
  object-fit: contain;          /* âœ¨ ì˜ë¦¬ì§€ ì•Šê³  í†µì§¸ë¡œ ë³´ì´ê²Œ */
  display: block;
}
        /* ì´ë¯¸ì§€ ì—†ì„ ë•Œ í…ìŠ¤íŠ¸ í”Œë ˆì´ìŠ¤í™€ë” (ê¹¨ì§„ ì´ë¯¸ì§€ ì•„ì´ì½˜ ì•ˆ ë³´ì´ê²Œ) */
        .clo-card-img-placeholder {
          width: 100%;
          height: 100%;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 12px;
          color: #9ca3af;
        }

        .clo-card-like-btn {
          position: absolute;
          right: 14px;
          bottom: 14px;
          padding: 6px 12px;
          border-radius: 999px;
          border: none;
          background: rgba(248,250,252,0.95);
          color: #b91c1c;
          font-size: 12px;
          cursor: pointer;
          display: inline-flex;
          align-items: center;
          gap: 4px;
        }
        .clo-card-like-btn span {
          font-size: 13px;
        }

        .clo-card-body {
          padding: 12px 16px 14px;
          display: flex;
          flex-direction: column;
          gap: 6px;
        }
        .clo-card-title {
          margin: 0;
          font-size: 15px;
          font-weight: 800;
        }
        .clo-card-desc {
          margin: 0;
          font-size: 13px;
          color: #6b7280;
        }
        .clo-card-footer {
          margin-top: 8px;
          display: flex;
          align-items: center;
          justify-content: space-between;
          gap: 8px;
        }
        .clo-tag-row {
          display: flex;
          flex-wrap: wrap;
          gap: 4px;
        }
        .clo-pill {
          padding: 3px 8px;
          border-radius: 999px;
          background: #f3f4f6;
          font-size: 11px;
          color: #4b5563;
        }
        .clo-card-date {
          font-size: 11px;
          color: #9ca3af;
          white-space: nowrap;
        }

        .clo-empty {
          padding: 40px 0 20px;
          text-align: center;
          font-size: 14px;
          color: #9ca3af;
        }

        /* ===== ìƒì„¸ ì •ë³´ ëª¨ë‹¬ ===== */
        .clo-modal-backdrop {
          position: fixed;
          inset: 0;
          background: rgba(15,23,42,0.45);
          display: none;
          align-items: center;
          justify-content: center;
          z-index: 70;
        }
        .clo-modal-backdrop.show { display: flex; }
        .clo-detail-card {
          width: 520px;
          max-width: 90vw;
          max-height: 80vh;
          background: #ffffff;
          border-radius: 18px;
          box-shadow: 0 18px 40px rgba(15,23,42,0.25);
          overflow: hidden;
          display: flex;
          flex-direction: column;
        }
        .clo-detail-header {
          padding: 14px 18px 0;
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
          gap: 10px;
        }
        .clo-detail-header h3 {
          margin: 0;
          font-size: 18px;
          font-weight: 800;
        }
        .clo-detail-close {
          border: none;
          background: none;
          font-size: 18px;
          cursor: pointer;
          color: #9ca3af;
        }

        /* ëª¨ë‹¬ ìƒë‹¨ í° ì´ë¯¸ì§€ ì˜ì—­ (ì¶”ê°€) */
        /* ìƒì„¸ ëª¨ë‹¬ ìƒë‹¨ í° ì´ë¯¸ì§€: ì „ì²´ê°€ ë³´ì´ë„ë¡ contain */
.clo-detail-img-wrap {
  width: 100%;
  max-height: 360px;           /* ëª¨ë‹¬ì—ì„œëŠ” ë” í¬ê²Œ */
  overflow: hidden;
  border-radius: 14px;
  background: #e5e7eb;
  margin-bottom: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
}
.clo-detail-img {
  max-width: 100%;
  max-height: 100%;
  width: auto;
  height: auto;
  object-fit: contain;         /* âœ¨ ìœ„/ì•„ë˜/ì¢Œìš° ì•„ë¬´ ë°ë„ ì•ˆ ì˜ë¦¼ */
  display: block;
}

        .clo-detail-body {
          padding: 8px 18px 16px;
          overflow-y: auto;
          font-size: 13px;
        }
        .clo-detail-meta {
          margin-bottom: 8px;
          color: #6b7280;
        }
        .clo-detail-section-title {
          margin: 10px 0 4px;
          font-size: 13px;
          font-weight: 700;
        }
        .clo-detail-tags {
          display: flex;
          flex-wrap: wrap;
          gap: 4px;
          margin-bottom: 6px;
        }
        .clo-detail-tags .clo-pill { font-size: 11px; }
        .clo-detail-body ul {
          margin: 4px 0 0;
          padding-left: 18px;
        }

        /* ë°˜ì‘í˜• */
        @media (max-width: 960px) {
          .clo-main-wrap { padding: 0 16px 28px; }
          .clo-closet-grid { grid-template-columns: 1fr; }
          .clo-style-summary { margin-top: 16px; }
        }

        /* === AI ìŠ¤íƒ€ì¼ ì—°ë™ í•˜ì´ë¼ì´íŠ¸ (ì¶”ê°€) === */
        .clo-closet-card.is-main-style {
          border: 2px solid #f97316;
          box-shadow: 0 14px 32px rgba(249,115,22,0.25);
        }
        .clo-closet-card.is-sub-style {
          border: 2px dashed #facc15;
        }
        .clo-style-reco-badge {
          display: inline-flex;
          align-items: center;
          gap: 4px;
          padding: 3px 8px;
          border-radius: 999px;
          font-size: 10px;
          background: #fee2e2;
          color: #b91c1c;
          margin-bottom: 6px;
        }
        .clo-style-reco-badge span {
          font-size: 11px;
        }
        .clo-style-ai-line {
          display: block;
          margin-top: 4px;
          font-size: 12px;
          color: #4b5563;
        }
        /* === ìƒì„¸ ëª¨ë‹¬ ì´ë¯¸ì§€ ì „ì²´ ë³´ì´ë„ë¡ (ì¹´ë“œ ìŠ¤íƒ€ì¼ ë™ì¼) === */
.clo-detail-img-box {
    width: 100%;
    background: #f3f4f6;
    border-radius: 12px;
    padding: 16px 0;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 16px;
}

.clo-detail-img-box img {
    width: 65%;
    max-width: 360px;
    height: auto;
    object-fit: contain;
    display: block;
}
        #detailImgWrap { display:none !important; }
#detailImage {
    object-fit: contain !important;
    width: 100%;
    height: auto;
}
    </style>
</head>
<body>

<!-- ì‚¬ì´ë“œë°” -->
<nav class="clo-sidebar">
    <div>
        <div class="clo-sidebar-header">ë©”ë‰´</div>
        <div class="clo-sidebar-sub">Closetory ì˜·ì¥ ë©”ë‰´</div>
    </div>
    <ul class="clo-menu-list">
        <li class="clo-active" onclick="location.href='closet.html'">ë‚˜ë§Œì˜ ì˜·ì¥</li>
        <li onclick="location.href='color.html'">ì½”ë”” ìƒ‰ê° ì¶”ì²œ</li>
        <li onclick="location.href='situation.html'">ìƒí™©ë³„ ì½”ë”” ì¶”ì²œ</li>
        <li onclick="location.href='calendar.html'">ì£¼ê°„ ì½”ë”” ìº˜ë¦°ë”</li>
        <li onclick="location.href='ranking.html'">ì¸ê¸° ì½”ë”” ë­í‚¹</li>
    </ul>
    <div class="clo-sidebar-footer">
        Closetory Â· ì˜·ì¥ì—ì„œ êº¼ë‚´ëŠ” ì‘ì€ í–‰ë³µ
    </div>
</nav>
<div class="clo-backdrop"></div>

<!-- ìƒë‹¨ë°” -->
<header class="clo-topbar">
    <div class="clo-top-inner">
        <div class="clo-top-left">
            <button class="clo-hamburger" id="cloMenuBtn">â˜°</button>
            <div>
                <div class="clo-logo-main">
                    <a href="index.html">Closetory</a>
                </div>
                <div class="clo-logo-sub">ì˜·ì¥ì—ì„œ êº¼ë‚´ëŠ” ì‘ì€ í–‰ë³µ</div>
            </div>
        </div>
        <div class="clo-top-right">
            <form class="clo-search-form" onsubmit="return false;">
                <span class="clo-search-icon">ğŸ”</span>
                <input class="clo-search-input" type="text" placeholder="ì½”ë””, ì•„ì´í…œ ê²€ìƒ‰" />
            </form>
            <span class="clo-user-status" id="userStatus"></span>
            <button class="clo-top-btn" id="loginBtn">ë¡œê·¸ì¸</button>
            <button class="clo-top-btn" id="signupBtn">íšŒì›ê°€ì…</button>
            <button class="clo-top-btn primary" id="mypageBtn" style="display:none;">ë§ˆì´í˜ì´ì§€</button>
            <button class="clo-top-btn" id="logoutBtn" style="display:none;">ë¡œê·¸ì•„ì›ƒ</button>
        </div>
    </div>
</header>

<!-- ë©”ì¸ -->
<div class="clo-main-outer">
    <main class="clo-main-wrap">
        <section class="clo-page-title-box">
            <h1>ë‚˜ë§Œì˜ ì˜·ì¥</h1>
            <p>ë‹¤ë¥¸ í˜ì´ì§€ì—ì„œ â™¡ ë¥¼ ëˆ„ë¥´ë©´ ì´ê³³ì— ì½”ë””ê°€ ìŒ“ì…ë‹ˆë‹¤.</p>
        </section>

        <!-- ë‚˜ì˜ ìŠ¤íƒ€ì¼ ë¶„ì„ -->
        <section class="clo-style-summary" id="styleSummaryBox">
            <h2>ë‚˜ì˜ ìŠ¤íƒ€ì¼ ë¶„ì„</h2>
            <ul id="styleSummaryList">
                <li>ê°€ì¥ ë§ì´ ì„ íƒí•œ ìƒ‰ê°: <strong>-</strong></li>
                <li>ìì£¼ ì…ëŠ” ì½”ë”” íƒ€ì…: <strong>-</strong></li>
                <li>í˜„ì¬ ì˜·ì¥ì— ì €ì¥ëœ ì½”ë”” ìˆ˜: <strong>0ê°œ</strong></li>
            </ul>
            <small>ì„ íƒí•œ ì½”ë””ë“¤ì„ ê¸°ë°˜ìœ¼ë¡œ, ìì£¼ ì‚¬ìš©í•˜ëŠ” ìƒ‰ê°ê³¼ ìƒí™©ì„ ë¶„ì„í•´ ì¤ë‹ˆë‹¤.</small>
        </section>

        <!-- í•„í„° -->
        <section class="clo-filter-bar">
            <div class="clo-filter-left">
                <span class="clo-filter-label">ìƒ‰ê°</span>
                <button class="clo-chip" data-color="ë ˆë“œ">ë ˆë“œ</button>
                <button class="clo-chip" data-color="ë¸”ë£¨">ë¸”ë£¨</button>
                <button class="clo-chip" data-color="ê·¸ë¦°">ê·¸ë¦°</button>
                <button class="clo-chip" data-color="ë¸Œë¼ìš´">ë¸Œë¼ìš´</button>
                <button class="clo-chip" data-color="ì¹´í‚¤">ì¹´í‚¤</button>
                <button class="clo-chip" data-color="ê·¸ë ˆì´">ê·¸ë ˆì´</button>
                <button class="clo-chip" data-color="ë¸”ë™">ë¸”ë™</button>
                <button class="clo-chip" data-color="í™”ì´íŠ¸">í™”ì´íŠ¸</button>
                <button class="clo-filter-reset" id="resetFilterBtn">í•„í„° ì´ˆê¸°í™”</button>
            </div>
            <div class="clo-filter-right">
                <label>
                    <input type="checkbox" id="onlyFavChk" checked />
                    ì°œí•œ ì½”ë””ë§Œ ë³´ê¸°
                </label>
                <select class="clo-select" id="sortSelect">
                    <option value="new">ìµœì‹ ìˆœ</option>
                    <option value="old">ì˜¤ë˜ëœìˆœ</option>
                    <option value="name">ì´ë¦„ìˆœ</option>
                </select>
            </div>
        </section>

        <!-- ì¹´ë“œ ê·¸ë¦¬ë“œ -->
        <section id="closetGrid" class="clo-closet-grid"></section>
        <div id="emptyMessage" class="clo-empty" style="display:none;">
            ì•„ì§ ì°œí•œ ì½”ë””ê°€ ì—†ìŠµë‹ˆë‹¤. <br/>ë©”ì¸ í˜ì´ì§€ì—ì„œ ë§ˆìŒì— ë“œëŠ” ì½”ë””ì— â™¡ ë¥¼ ëˆŒëŸ¬ ë³´ì„¸ìš”.
        </div>
    </main>
</div>

<!-- ìƒì„¸ ì •ë³´ ëª¨ë‹¬ -->
<div class="clo-modal-backdrop" id="detailModal">
    <div class="clo-detail-card">
        <div class="clo-detail-header">
            <h3 id="detailTitle">ì½”ë”” ìƒì„¸ ì •ë³´</h3>
            <button class="clo-detail-close" id="detailCloseBtn">Ã—</button>
        </div>
        <div class="clo-detail-body">
            <!-- ğŸ”¥ ì½”ë”” í° ì´ë¯¸ì§€ ì˜ì—­ (ì¶”ê°€) -->
            <div class="clo-detail-img-box">
                <img id="detailImage" src="" alt="ì½”ë”” ì´ë¯¸ì§€" />
            </div>
            <div class="clo-detail-img-wrap" id="detailImgWrap" style="display:none;">
                <img src="" alt="ì½”ë”” ì´ë¯¸ì§€" class="clo-detail-img" id="detailImg">
            </div>

            <div class="clo-detail-meta" id="detailMeta"></div>

            <div class="clo-detail-section-title">ì„ íƒí•œ ìƒ‰ê° & ìƒí™©</div>
            <div class="clo-detail-tags" id="detailTags"></div>

            <div class="clo-detail-section-title">ì½”ë”” ì„¤ëª…</div>
            <p id="detailDesc"></p>

            <div class="clo-detail-section-title">ìŠ¤íƒ€ì¼ ë¶„ì„</div>
            <ul id="detailStyleList"></ul>

            <div class="clo-detail-section-title">ì¶”ì²œ ì½”ë”” íŒ</div>
            <ul id="detailRecommendList"></ul>
        </div>
    </div>
</div>
<script>
    /* ===== ê³µí†µ: ì‚¬ì´ë“œë°” & ë¡œê·¸ì¸ ìƒíƒœ ===== */
    const bodyEl = document.body;
    const menuBtn = document.getElementById('cloMenuBtn');
    const backdrop = document.querySelector('.clo-backdrop');

    function toggleSidebar() {
      bodyEl.classList.toggle('clo-sidebar-open');
    }
    menuBtn.addEventListener('click', toggleSidebar);
    backdrop.addEventListener('click', toggleSidebar);

    const loginBtn   = document.getElementById('loginBtn');
    const signupBtn  = document.getElementById('signupBtn');
    const logoutBtn  = document.getElementById('logoutBtn');
    const mypageBtn  = document.getElementById('mypageBtn');
    const userStatus = document.getElementById('userStatus');

    function checkAuthState() {
      const raw = localStorage.getItem('closetoryUser');
      if (raw) {
        const user = JSON.parse(raw);
        userStatus.textContent = (user.name || 'ì‚¬ìš©ì') + ' ë‹˜ ë¡œê·¸ì¸ ì¤‘';
        loginBtn.style.display   = 'none';
        signupBtn.style.display  = 'none';
        mypageBtn.style.display  = 'inline-flex';
        logoutBtn.style.display  = 'inline-flex';
      } else {
        userStatus.textContent = '';
        loginBtn.style.display   = 'inline-flex';
        signupBtn.style.display  = 'inline-flex';
        mypageBtn.style.display  = 'none';
        logoutBtn.style.display  = 'none';
      }
    }

    loginBtn.addEventListener('click', () => location.href = 'login.html');
    signupBtn.addEventListener('click', () => location.href = 'signup.html');
    mypageBtn.addEventListener('click', () => location.href = 'mypage.html');
    logoutBtn.addEventListener('click', () => {
      localStorage.removeItem('closetoryUser');
      checkAuthState();
      alert('ë¡œê·¸ì•„ì›ƒ ë˜ì—ˆìŠµë‹ˆë‹¤.');
      location.href = 'index.html';
    });
    checkAuthState();

    /* ===== ë‚˜ë§Œì˜ ì˜·ì¥ ë°ì´í„° ===== */
    const FAVORITES_KEY = 'closetoryFavorites';

    function loadFavorites() {
      try {
        return JSON.parse(localStorage.getItem(FAVORITES_KEY) || '[]');
      } catch (_) {
        return [];
      }
    }

    function saveFavorites(list) {
      localStorage.setItem(FAVORITES_KEY, JSON.stringify(list));
    }

    /* ===== ìŠ¤íƒ€ì¼ ë¶„ì„ (ìƒë‹¨ ë°•ìŠ¤) ===== */
    function updateStyleSummary(favs) {
      const listEl = document.getElementById('styleSummaryList');
      const total = favs.length;

      if (!total) {
        listEl.innerHTML = `
          <li>ê°€ì¥ ë§ì´ ì„ íƒí•œ ìƒ‰ê°: <strong>-</strong></li>
          <li>ìì£¼ ì…ëŠ” ì½”ë”” íƒ€ì…: <strong>-</strong></li>
          <li>í˜„ì¬ ì˜·ì¥ì— ì €ì¥ëœ ì½”ë”” ìˆ˜: <strong>0ê°œ</strong></li>`;
        return;
      }

      const colorCount = {};
      const typeCount = {};

      favs.forEach(it => {
        const colors = it.colors || it.colorTags || it.tags || [];
        const types  = it.types || it.situations || it.categories || it.tags || [];

        (colors || []).forEach(c => {
          colorCount[c] = (colorCount[c] || 0) + 1;
        });
        (types || []).forEach(t => {
          typeCount[t] = (typeCount[t] || 0) + 1;
        });
      });

      function pickTop(map) {
        let bestKey = '-';
        let bestVal = 0;
        for (const k in map) {
          if (map[k] > bestVal) {
            bestVal = map[k];
            bestKey = k;
          }
        }
        return bestKey;
      }

      const bestColor = pickTop(colorCount);
      const bestType  = pickTop(typeCount);

      listEl.innerHTML = `
        <li>ê°€ì¥ ë§ì´ ì„ íƒí•œ ìƒ‰ê°: <strong>${bestColor}</strong></li>
        <li>ìì£¼ ì…ëŠ” ì½”ë”” íƒ€ì…: <strong>${bestType}</strong></li>
        <li>í˜„ì¬ ì˜·ì¥ì— ì €ì¥ëœ ì½”ë”” ìˆ˜: <strong>${total}ê°œ</strong></li>`;
    }

    /* ===== í•„í„° / ë Œë”ë§ ===== */
    const chipEls      = Array.from(document.querySelectorAll('.clo-chip'));
    const resetBtn     = document.getElementById('resetFilterBtn');
    const onlyFavChk   = document.getElementById('onlyFavChk');
    const sortSelect   = document.getElementById('sortSelect');
    const gridEl       = document.getElementById('closetGrid');
    const emptyMsgEl   = document.getElementById('emptyMessage');

    let activeColor = null;

    chipEls.forEach(chip => {
      chip.addEventListener('click', () => {
        const color = chip.dataset.color;
        if (activeColor === color) {
          activeColor = null;
          chip.classList.remove('active');
        } else {
          activeColor = color;
          chipEls.forEach(c => c.classList.toggle('active', c.dataset.color === color));
        }
        renderCloset();
      });
    });

    resetBtn.addEventListener('click', () => {
      activeColor = null;
      chipEls.forEach(c => c.classList.remove('active'));
      sortSelect.value = 'new';
      renderCloset();
    });

    onlyFavChk.addEventListener('change', renderCloset);
    sortSelect.addEventListener('change', renderCloset);

    function applyFilterAndSort(list) {
      let arr = [...list];

      // ìƒ‰ê° í•„í„°
      if (activeColor) {
        arr = arr.filter(it => {
          const colors = it.colors || it.colorTags || it.tags || [];
          return colors.includes(activeColor);
        });
      }

      // (ì˜µì…˜) ì°œí•œ ì½”ë””ë§Œ: closetì€ ì›ë˜ ì°œ ëª¨ìŒì´ë¼ í•­ìƒ trueì§€ë§Œ, í˜¹ì‹œ ì¼ë°˜ ë¦¬ìŠ¤íŠ¸ì™€ ì„ì¼ ë•Œ ëŒ€ë¹„
      if (onlyFavChk.checked) {
        arr = arr.filter(it => it.isFavorite !== false);
      }

      // ì •ë ¬
      const mode = sortSelect.value;
      arr.sort((a, b) => {
        const nameA = (a.title || '').localeCompare(b.title || '', 'ko');
        const tA = a.createdAt || 0;
        const tB = b.createdAt || 0;

        if (mode === 'name') return nameA;
        if (mode === 'old') return tA - tB;
        // ê¸°ë³¸: ìµœì‹ ìˆœ
        return tB - tA;
      });

      return arr;
    }

    function formatDate(ts) {
      if (!ts) return '';
      const d = new Date(ts);
      const y = d.getFullYear();
      const m = String(d.getMonth() + 1).padStart(2, '0');
      const day = String(d.getDate()).padStart(2, '0');
      return `${y}.${m}.${day}`;
    }

    function renderCloset() {
      const favorites = loadFavorites();
      updateStyleSummary(favorites);

      const viewList = applyFilterAndSort(favorites);

      gridEl.innerHTML = '';
      if (!viewList.length) {
        emptyMsgEl.style.display = 'block';
        // AI ìŠ¤íƒ€ì¼ ë°˜ì˜ë„ ê°™ì´ ì´ˆê¸°í™”
        applyStyleProfileToCloset();
        return;
      }
      emptyMsgEl.style.display = 'none';

      viewList.forEach(item => {
        const card = document.createElement('article');
        card.className = 'clo-closet-card';
        card.dataset.id = item.id;

        const imgWrap = document.createElement('div');
        imgWrap.className = 'clo-card-img-wrap';

        // ğŸ”¥ ì´ë¯¸ì§€ ê¹¨ì§ ë°©ì§€: imageUrl ì—†ìœ¼ë©´ <img> ìì²´ë¥¼ ë§Œë“¤ì§€ ì•Šê³  í”Œë ˆì´ìŠ¤í™€ë” í‘œì‹œ
        if (item.imageUrl) {
          const img = document.createElement('img');
          img.className = 'clo-card-img';
          img.src = item.imageUrl;
          img.alt = item.title || 'ì½”ë”” ì´ë¯¸ì§€';
          imgWrap.appendChild(img);
        } else {
          const ph = document.createElement('div');
          ph.className = 'clo-card-img-placeholder';
          ph.textContent = 'ì´ë¯¸ì§€ ì—†ìŒ';
          imgWrap.appendChild(ph);
        }

        const likeBtn = document.createElement('button');
        likeBtn.className = 'clo-card-like-btn';
        likeBtn.innerHTML = '<span>â™¥</span> ì°œ í•´ì œ';
        likeBtn.addEventListener('click', e => {
          e.stopPropagation();
          removeFavorite(item.id);
        });
        imgWrap.appendChild(likeBtn);

        const body = document.createElement('div');
        body.className = 'clo-card-body';

        const title = document.createElement('h3');
        title.className = 'clo-card-title';
        title.textContent = item.title || 'ì´ë¦„ ì—†ëŠ” ì½”ë””';
        body.appendChild(title);

        const desc = document.createElement('p');
        desc.className = 'clo-card-desc';
        desc.textContent = item.description || 'ì½”ë”” ì„¤ëª…ì´ ì•„ì§ ì—†ìŠµë‹ˆë‹¤.';
        body.appendChild(desc);

        const footer = document.createElement('div');
        footer.className = 'clo-card-footer';

        const tagRow = document.createElement('div');
        tagRow.className = 'clo-tag-row';

        const colors = item.colors || item.colorTags || [];
        const tags   = item.types || item.situations || item.categories || item.tags || [];

        const mergedTags = [...new Set([...(colors || []), ...(tags || [])])].slice(0, 3);
        mergedTags.forEach(t => {
          const pill = document.createElement('span');
          pill.className = 'clo-pill';
          pill.textContent = t;
          tagRow.appendChild(pill);
        });
        footer.appendChild(tagRow);

        const date = document.createElement('span');
        date.className = 'clo-card-date';
        date.textContent = formatDate(item.createdAt);
        footer.appendChild(date);

        body.appendChild(footer);

        card.appendChild(imgWrap);
        card.appendChild(body);

        card.addEventListener('click', () => openDetailModal(item));

        gridEl.appendChild(card);
      });

      // === ì—¬ê¸°ì„œ AI ìŠ¤íƒ€ì¼ í•˜ì´ë¼ì´íŠ¸ ì ìš© (ì¶”ê°€) ===
      applyStyleProfileToCloset();
    }
    function removeFavorite(id) {
      const list = loadFavorites();
      const idx = list.findIndex(it => it.id === id);
      if (idx !== -1) {
        list.splice(idx, 1);
        saveFavorites(list);
        renderCloset();
      }
    }

    /* ===== ìƒì„¸ ì •ë³´ ëª¨ë‹¬ ===== */
    const modalEl   = document.getElementById('detailModal');
    const modalCloseBtn = document.getElementById('detailCloseBtn');
    const detailTitleEl = document.getElementById('detailTitle');
    const detailMetaEl  = document.getElementById('detailMeta');
    const detailTagsEl  = document.getElementById('detailTags');
    const detailDescEl  = document.getElementById('detailDesc');
    const detailStyleListEl = document.getElementById('detailStyleList');
    const detailRecommendListEl = document.getElementById('detailRecommendList');
    // ğŸ”¥ ìƒˆë¡œ ì¶”ê°€: ëª¨ë‹¬ ì´ë¯¸ì§€ ìš”ì†Œ
    const detailImgWrapEl = document.getElementById('detailImgWrap');
    const detailImgEl     = document.getElementById('detailImg');

    function openDetailModal(item) {
      detailTitleEl.textContent = item.title || 'ì½”ë”” ìƒì„¸ ì •ë³´';
      // ìƒì„¸ ì´ë¯¸ì§€ í‘œì‹œ (ì „ì²´ ë³´ì´ëŠ” ìŠ¤íƒ€ì¼)
const detailImageEl = document.getElementById('detailImage');
detailImageEl.src = item.imageUrl || "";
detailImageEl.alt = item.title || "ì½”ë”” ì´ë¯¸ì§€";
      detailMetaEl.textContent  = formatDate(item.createdAt) || 'ë‚ ì§œ ì •ë³´ ì—†ìŒ';

      // ìƒë‹¨ í° ì´ë¯¸ì§€ ì„¸íŒ…
      if (item.imageUrl) {
        detailImgEl.src = item.imageUrl;
        detailImgEl.alt = item.title || 'ì½”ë”” ì´ë¯¸ì§€';
        detailImgWrapEl.style.display = 'block';
      } else {
        detailImgEl.src = '';
        detailImgWrapEl.style.display = 'none';
      }

      detailTagsEl.innerHTML = '';
      const colors = item.colors || item.colorTags || [];
      const tags   = item.types || item.situations || item.categories || item.tags || [];
      [...new Set([...(colors || []), ...(tags || [])])].forEach(t => {
        const pill = document.createElement('span');
        pill.className = 'clo-pill';
        pill.textContent = t;
        detailTagsEl.appendChild(pill);
      });

      detailDescEl.textContent = item.description || 'ì½”ë”” ì„¤ëª…ì´ ë“±ë¡ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.';

      // ìŠ¤íƒ€ì¼ ë¶„ì„ (ê°„ë‹¨ ë£° ê¸°ë°˜)
      detailStyleListEl.innerHTML = '';
      const styleHints = [];

      if (colors.includes('ë¸”ë™')) styleHints.push('ë¸”ë™ ë¹„ì¤‘ì´ ë†’ì•„ ëª¨ë…¸í†¤, ì‹œí¬í•œ ëŠë‚Œì˜ ìŠ¤íƒ€ì¼ì„ ì„ í˜¸í•©ë‹ˆë‹¤.');
      if (colors.includes('í™”ì´íŠ¸')) styleHints.push('í™”ì´íŠ¸ê°€ í¬í•¨ë˜ì–´ ì „ì²´ì ìœ¼ë¡œ ë°ê³  ê¹¨ë—í•œ ì¸ìƒì„ ì¤ë‹ˆë‹¤.');
      if (colors.includes('ì¹´í‚¤') || colors.includes('ë¸Œë¼ìš´')) styleHints.push('ì–´ìŠ¤ ê³„ì—´ ìƒ‰ê°ìœ¼ë¡œ ìºì£¼ì–¼í•˜ê³  ìì—°ìŠ¤ëŸ¬ìš´ ë¶„ìœ„ê¸°ë¥¼ ì—°ì¶œí•©ë‹ˆë‹¤.');
      if (tags.includes('ìš´ë™') || tags.includes('ìŠ¤í¬ì¸ ')) styleHints.push('í™œë™ì„±ì´ ì¤‘ìš”í•´ í¸ì•ˆí•¨ ì¤‘ì‹¬ì˜ ì½”ë””ë¥¼ ìì£¼ ì„ íƒí•©ë‹ˆë‹¤.');
      if (tags.includes('ë°ì´íŠ¸')) styleHints.push('ë°ì´íŠ¸ ìƒí™©ì—ì„œ í¬ì¸íŠ¸ë¥¼ ì¤„ ìˆ˜ ìˆëŠ” ê°ì„± ì½”ë””ë¥¼ ì¢‹ì•„í•©ë‹ˆë‹¤.');

      if (!styleHints.length) styleHints.push('ì»¬ëŸ¬ì™€ íƒœê·¸ ì •ë³´ê°€ ì•„ì§ ì ì–´, ê¸°ë³¸ì ì¸ ìºì£¼ì–¼ ìŠ¤íƒ€ì¼ë¡œ ë¶„ì„ë©ë‹ˆë‹¤.');

      styleHints.forEach(t => {
        const li = document.createElement('li');
        li.textContent = t;
        detailStyleListEl.appendChild(li);
      });

      // ì¶”ì²œ ì½”ë”” íŒ
      detailRecommendListEl.innerHTML = '';
      const reco = [];

      if (colors.includes('ë¸”ë™') || colors.includes('ê·¸ë ˆì´')) {
        reco.push('ëª¨ë…¸í†¤ ì½”ë””ì—ëŠ” ë°ì€ ì»¬ëŸ¬ ìŠ¤ë‹ˆì»¤ì¦ˆë‚˜ ê°€ë°©ìœ¼ë¡œ í¬ì¸íŠ¸ë¥¼ ì¶”ê°€í•´ ë³´ì„¸ìš”.');
      }
      if (colors.includes('ë¸Œë¼ìš´') || colors.includes('ì¹´í‚¤')) {
        reco.push('ë¸Œë¼ìš´/ì¹´í‚¤ ê³„ì—´ì—ëŠ” ì•„ì´ë³´ë¦¬ ë‹ˆíŠ¸ë‚˜ ì…”ì¸ ë¥¼ ë§¤ì¹˜í•˜ë©´ ë¶€ë“œëŸ¬ìš´ ëŠë‚Œì„ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
      }
      if (tags.includes('ìº í¼ìŠ¤')) {
        reco.push('ìº í¼ìŠ¤ ì½”ë””ì—ëŠ” ë°±íŒ© + ìº¡ëª¨ìë¥¼ í•¨ê»˜ ë§¤ì¹˜í•˜ë©´ í™œë™ì„±ë„ ì‚´ê³  ìŠ¤íƒ€ì¼ë„ ì‚´ì•„ë‚©ë‹ˆë‹¤.');
      }
      if (tags.includes('ì—¬í–‰')) {
        reco.push('ì—¬í–‰ ì½”ë””ëŠ” ë ˆì´ì–´ë“œê°€ ì¤‘ìš”í•˜ë‹ˆ, ê°€ë²¼ìš´ ì•„ìš°í„°ë¥¼ ì¶”ê°€ë¡œ ì±™ê²¨ ë‘ë©´ ì˜¨ë„ ë³€í™”ì— ëŒ€ì²˜í•˜ê¸° ì¢‹ìŠµë‹ˆë‹¤.');
      }
      if (!reco.length) {
        reco.push('í˜„ì¬ ì½”ë””ì— ë¨¸í”ŒëŸ¬ë‚˜ ì•…ì„¸ì„œë¦¬ë¥¼ í•œ ê°€ì§€ ì¶”ê°€í•˜ë©´, ë¶„ìœ„ê¸°ë¥¼ ì™„ì „íˆ ë°”ê¿€ ìˆ˜ ìˆì–´ìš”.');
      }

      reco.forEach(t => {
        const li = document.createElement('li');
        li.textContent = t;
        detailRecommendListEl.appendChild(li);
      });

      modalEl.classList.add('show');
    }

    function closeDetailModal() {
      modalEl.classList.remove('show');
    }

    modalCloseBtn.addEventListener('click', closeDetailModal);
    modalEl.addEventListener('click', e => {
      if (e.target === modalEl) closeDetailModal();
    });

    /* === AI ìŠ¤íƒ€ì¼ ì—°ë™ í•¨ìˆ˜ (ì¶”ê°€) === */
    const STYLE_STORAGE_KEY = 'closetoryStyleProfile';

    function loadStyleProfile() {
      try {
        const raw = localStorage.getItem(STYLE_STORAGE_KEY);
        return raw ? JSON.parse(raw) : null;
      } catch (e) {
        console.warn('ìŠ¤íƒ€ì¼ í”„ë¡œí•„ íŒŒì‹± ì‹¤íŒ¨', e);
        return null;
      }
    }

    // ìƒ‰ê°/íƒœê·¸ ê¸°ë°˜ìœ¼ë¡œ ì´ ì½”ë””ê°€ ì–´ë–¤ ìŠ¤íƒ€ì¼ í‚¤ë“¤ê³¼ ì–´ìš¸ë¦¬ëŠ”ì§€ ì¶”ì •
    function guessCardStyleKeys(item) {
      const colors = item.colors || item.colorTags || [];
      const tags   = item.types || item.situations || item.categories || item.tags || [];
      const keys = new Set();

      // ìƒ‰ ê¸°ì¤€
      if (colors.some(c => ['ë¸”ë™','í™”ì´íŠ¸','ê·¸ë ˆì´'].includes(c))) {
        keys.add('minimal');
      }
      if (colors.some(c => ['ë¸”ë£¨','ë„¤ì´ë¹„','ê·¸ë¦°'].includes(c))) {
        keys.add('casual');
      }
      if (colors.some(c => ['í•‘í¬','ë² ì´ì§€','ì•„ì´ë³´ë¦¬','í™”ì´íŠ¸'].includes(c))) {
        keys.add('lovely');
      }
      if (colors.some(c => ['ë¸Œë¼ìš´','ì¹´í‚¤'].includes(c))) {
        keys.add('vintage');
      }
      // íƒœê·¸ ê¸°ì¤€
      if (tags.some(t => ['ìš´ë™','ìŠ¤í¬ì¸ ','ëŸ¬ë‹','í—¬ìŠ¤','íŠ¸ë ˆì´ë‹'].includes(t))) {
        keys.add('sporty');
      }
      if (tags.some(t => ['ë°ì´íŠ¸'].includes(t))) {
        keys.add('lovely');
      }
      if (tags.some(t => ['ë°œí‘œ','í”„ë ˆì  í…Œì´ì…˜','ì„¸ë¯¸í¬ë©€'].includes(t))) {
        keys.add('minimal');
      }
      if (!keys.size) {
        keys.add('casual'); // ê¸°ë³¸ê°’
      }
      return Array.from(keys);
    }

    function applyStyleProfileToCloset() {
      const profile = loadStyleProfile();
      const cards   = document.querySelectorAll('.clo-closet-card');
      const summaryBox = document.getElementById('styleSummaryBox');

      // ìƒë‹¨ ë°•ìŠ¤ì— AI ê²°ê³¼ í•œ ì¤„ í‘œì‹œ
      const aiLineId = 'clo-style-ai-line';
      let aiLine = document.getElementById(aiLineId);
      if (!aiLine && summaryBox) {
        aiLine = document.createElement('span');
        aiLine.id = aiLineId;
        aiLine.className = 'clo-style-ai-line';
        summaryBox.appendChild(aiLine);
      }
      if (aiLine) {
        if (!profile) {
          aiLine.textContent = 'AI ìŠ¤íƒ€ì¼ í…ŒìŠ¤íŠ¸ ê²°ê³¼ê°€ ì•„ì§ ì—†ìŠµë‹ˆë‹¤. ë©”ì¸ í˜ì´ì§€ì—ì„œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ë©´, ì—¬ê¸°ì—ë„ ê²°ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤.';
        } else {
          const mainLabel = profile.mainLabel || profile.mainKey || '';
          const subLabel  = profile.subLabel  || profile.subKey  || '';
          aiLine.textContent = subLabel
            ? `AI ë¶„ì„ ê¸°ì¤€ ë©”ì¸ ìŠ¤íƒ€ì¼: ${mainLabel} Â· ì„œë¸Œ ìŠ¤íƒ€ì¼: ${subLabel}`
            : `AI ë¶„ì„ ê¸°ì¤€ ë©”ì¸ ìŠ¤íƒ€ì¼: ${mainLabel}`;
        }
      }

      if (!cards.length || !profile) return;

      const { mainKey, subKey } = profile;

      // id â†’ favorite ë§¤í•‘
      const favs = loadFavorites();
      const map = {};
      favs.forEach(it => { map[it.id] = it; });

      cards.forEach(card => {
        card.classList.remove('is-main-style','is-sub-style');
        const oldBadge = card.querySelector('.clo-style-reco-badge');
        if (oldBadge) oldBadge.remove();

        const id = card.dataset.id;
        const item = map[id];
        if (!item) return;

        const styleKeys = guessCardStyleKeys(item);
        let badgeType = null;

        if (styleKeys.includes(mainKey)) {
          card.classList.add('is-main-style');
          badgeType = 'main';
        } else if (styleKeys.includes(subKey)) {
          card.classList.add('is-sub-style');
          badgeType = 'sub';
        }

        if (badgeType) {
          const badge = document.createElement('div');
          badge.className = 'clo-style-reco-badge';
          const label = badgeType === 'main' ? 'AI ë©”ì¸ ìŠ¤íƒ€ì¼ ì¶”ì²œ' : 'AI ì„œë¸Œ ìŠ¤íƒ€ì¼ ì¶”ì²œ';
          badge.innerHTML = `<span>â˜…</span>${label}`;

          const body = card.querySelector('.clo-card-body');
          if (body) {
            body.insertBefore(badge, body.firstElementChild);
          } else {
            card.insertBefore(badge, card.firstElementChild);
          }
        }
      });
    }

    /* ===== ì´ˆê¸° ë Œë” ===== */
    renderCloset();
</script>
</body>
</html>